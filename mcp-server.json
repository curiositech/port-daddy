{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "port-daddy",
  "version": "3.1.0",
  "description": "The authoritative port manager for multi-agent development. Claim ports, coordinate agents, manage sessions and notes.",
  "homepage": "https://github.com/curiositech/port-daddy",
  "repository": "https://github.com/curiositech/port-daddy",
  "license": "MIT",
  "author": "Curiositech",
  "capabilities": {
    "tools": {
      "listChanged": false
    }
  },
  "tools": [
    {
      "name": "port_daddy_claim",
      "title": "Claim Port",
      "description": "Claim a port for a service. Returns the same port every time for a given identity. Use format 'project:stack:context' for semantic naming.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "identity": {
            "type": "string",
            "description": "Service identity in format 'project:stack:context' (e.g., 'myapp:api:main', 'myapp:frontend'). All parts except project are optional."
          },
          "port": {
            "type": "integer",
            "description": "Optional specific port to claim. If not provided, one will be assigned."
          },
          "pid": {
            "type": "integer",
            "description": "Process ID owning this port claim."
          }
        },
        "required": ["identity"]
      }
    },
    {
      "name": "port_daddy_release",
      "title": "Release Port",
      "description": "Release a claimed port. Supports wildcards (e.g., 'myapp:*' releases all myapp services).",
      "inputSchema": {
        "type": "object",
        "properties": {
          "identity": {
            "type": "string",
            "description": "Service identity or wildcard pattern to release."
          }
        },
        "required": ["identity"]
      }
    },
    {
      "name": "port_daddy_find",
      "title": "Find Services",
      "description": "Find services by pattern. Returns matching services with their ports.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "pattern": {
            "type": "string",
            "description": "Pattern to match (supports wildcards). E.g., 'myapp:*', '*:api:*'."
          }
        },
        "required": ["pattern"]
      }
    },
    {
      "name": "port_daddy_lock",
      "title": "Acquire Lock",
      "description": "Acquire a distributed lock. Blocks until lock is acquired or timeout.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Lock name (unique identifier for this lock)."
          },
          "owner": {
            "type": "string",
            "description": "Lock owner identifier (e.g., agent ID)."
          },
          "ttl": {
            "type": "integer",
            "description": "Time-to-live in seconds. Lock expires after this duration. Default: 60."
          },
          "wait": {
            "type": "boolean",
            "description": "If true, wait for lock to become available. If false, fail immediately if locked."
          },
          "timeout": {
            "type": "integer",
            "description": "Maximum time to wait in milliseconds (only used if wait=true). Default: 30000."
          }
        },
        "required": ["name", "owner"]
      }
    },
    {
      "name": "port_daddy_unlock",
      "title": "Release Lock",
      "description": "Release a distributed lock.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Lock name to release."
          },
          "owner": {
            "type": "string",
            "description": "Lock owner identifier. Must match the owner who acquired the lock."
          }
        },
        "required": ["name", "owner"]
      }
    },
    {
      "name": "port_daddy_session_start",
      "title": "Start Session",
      "description": "Start a new coordination session. Sessions track work across multiple agents and provide file conflict detection.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "purpose": {
            "type": "string",
            "description": "Brief description of what this session is for (e.g., 'Implementing dark mode')."
          },
          "files": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Optional list of files to claim for this session."
          },
          "agentId": {
            "type": "string",
            "description": "Optional agent ID to associate with this session."
          }
        },
        "required": ["purpose"]
      }
    },
    {
      "name": "port_daddy_session_end",
      "title": "End Session",
      "description": "End the current active session.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "note": {
            "type": "string",
            "description": "Optional closing note/summary for the session."
          },
          "status": {
            "type": "string",
            "enum": ["completed", "abandoned"],
            "description": "Session completion status. Default: 'completed'."
          }
        },
        "additionalProperties": false
      }
    },
    {
      "name": "port_daddy_note",
      "title": "Add Note",
      "description": "Add a note to the current session. Notes are immutable and form an audit trail of agent coordination.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "content": {
            "type": "string",
            "description": "Note content. Can use inline markup: @agent-id, #file:path/to/file, $session-id."
          },
          "type": {
            "type": "string",
            "enum": ["note", "handoff", "commit", "warning"],
            "description": "Note type for categorization. Default: 'note'."
          }
        },
        "required": ["content"]
      }
    },
    {
      "name": "port_daddy_notes",
      "title": "List Notes",
      "description": "Get notes from the current session or all recent notes.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "Optional session ID. If not provided, returns notes from active session."
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of notes to return. Default: 50."
          },
          "type": {
            "type": "string",
            "description": "Filter by note type."
          }
        },
        "additionalProperties": false
      }
    },
    {
      "name": "port_daddy_publish",
      "title": "Publish Message",
      "description": "Publish a message to a pub/sub channel for agent-to-agent communication.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "channel": {
            "type": "string",
            "description": "Channel name in format 'scope:topic:qualifier' (e.g., 'bridge:myapp:helm', 's2s:agent-a:agent-b')."
          },
          "message": {
            "type": "string",
            "description": "Message content."
          },
          "sender": {
            "type": "string",
            "description": "Sender identifier."
          }
        },
        "required": ["channel", "message"]
      }
    },
    {
      "name": "port_daddy_status",
      "title": "Daemon Status",
      "description": "Get Port Daddy daemon status including active services, locks, agents, and sessions.",
      "inputSchema": {
        "type": "object",
        "additionalProperties": false
      }
    },
    {
      "name": "port_daddy_agent_register",
      "title": "Register Agent",
      "description": "Register this agent with Port Daddy. Registration enables inbox messaging, resurrection if you die, and priority in lock acquisition. Call this at the start of every agent session.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "agentId": {
            "type": "string",
            "description": "Unique agent identifier (e.g., 'claude-code-abc123', 'cursor-session-1')."
          },
          "name": {
            "type": "string",
            "description": "Human-readable name for this agent."
          },
          "type": {
            "type": "string",
            "description": "Agent type (e.g., 'cli', 'vscode', 'cursor', 'claude-code')."
          },
          "purpose": {
            "type": "string",
            "description": "What this agent is working on. Helps other agents understand context if you die."
          }
        },
        "required": ["agentId"]
      }
    },
    {
      "name": "port_daddy_agent_heartbeat",
      "title": "Agent Heartbeat",
      "description": "Send a heartbeat to indicate this agent is still alive. Call every 5 minutes to avoid being marked stale (10min) or dead (20min).",
      "inputSchema": {
        "type": "object",
        "properties": {
          "agentId": {
            "type": "string",
            "description": "Your agent identifier."
          }
        },
        "required": ["agentId"]
      }
    },
    {
      "name": "port_daddy_salvage",
      "title": "Check Salvage Queue",
      "description": "Check if any agents died with unfinished work. Returns sessions and notes from dead agents that can be continued. Call this at the start of work to pick up abandoned tasks.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "claim": {
            "type": "string",
            "description": "Optional: agent ID to claim for resurrection. If provided, marks the agent as being resurrected by you."
          }
        },
        "additionalProperties": false
      }
    },
    {
      "name": "port_daddy_changelog_add",
      "title": "Add Changelog Entry",
      "description": "Record a change in the hierarchical changelog. Use semantic identities (project:service:feature) for automatic rollup. Call after completing meaningful work.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "identity": {
            "type": "string",
            "description": "Semantic identity of what changed (e.g., 'myapp:api:auth', 'myapp:frontend'). Changes roll up to parent levels automatically."
          },
          "summary": {
            "type": "string",
            "description": "One-line summary of the change (like a git commit message)."
          },
          "type": {
            "type": "string",
            "enum": ["feature", "fix", "refactor", "docs", "chore", "breaking"],
            "description": "Type of change. Default: 'feature'."
          },
          "description": {
            "type": "string",
            "description": "Optional detailed description (markdown supported)."
          },
          "sessionId": {
            "type": "string",
            "description": "Optional session ID to link this change to."
          }
        },
        "required": ["identity", "summary"]
      }
    },
    {
      "name": "port_daddy_changelog_list",
      "title": "List Changelog",
      "description": "List recent changelog entries. Use to see what's been done across a project or service.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "identity": {
            "type": "string",
            "description": "Optional: filter to this identity and its children (e.g., 'myapp' shows all myapp changes)."
          },
          "limit": {
            "type": "integer",
            "description": "Maximum entries to return. Default: 20."
          },
          "format": {
            "type": "string",
            "enum": ["json", "flat", "tree", "keep-a-changelog"],
            "description": "Output format. 'json' for structured data, others for markdown."
          }
        },
        "additionalProperties": false
      }
    }
  ],
  "transport": {
    "type": "http",
    "url": "http://localhost:9876"
  },
  "tags": [
    "ports",
    "coordination",
    "agents",
    "sessions",
    "locks",
    "messaging"
  ]
}
